##ignorewarning invalid_data_line_quotes
##ignorewarning raw_object_notation

SkinTextureSignatures:
    type: data
    alchemist:
    - ewogICJ0aW1lc3RhbXAiIDogMTYxOTA0MDEzMDc5NiwKICAicHJvZmlsZUlkIiA6ICI5OTdjZjFlMmY1NGQ0YzEyOWY2ZjU5ZTVlNjU1YjZmNyIsCiAgInByb2ZpbGVOYW1lIiA6ICJpbzEyIiwKICAic2lnbmF0dXJlUmVxdWlyZWQiIDogdHJ1ZSwKICAidGV4dHVyZXMiIDogewogICAgIlNLSU4iIDogewogICAgICAidXJsIiA6ICJodHRwOi8vdGV4dHVyZXMubWluZWNyYWZ0Lm5ldC90ZXh0dXJlL2RmMjY0YmRhYmEyYjQyMjBiZTBkNmE4ODk1ZTRjNzQ5ZDQ1ZWQwNzQwODcyYzUyNTE5ZTIyY2FkODkxMzA2MTYiCiAgICB9CiAgfQp9;WPCQv3IKnoR59fgPILMqOBtRcCL6gMmeUV8F4/nP7yGQH06MtZqRi9SIEQkyzOyjNuSKEidsr8vYd5zb/COVNqI3cXAXHTHKr/5jKgRffF+OZ9ChK+2/M65PsYbd1Zf/ygC7lkp7w5oiiuBA06SgOm1oml66vrDOqratu4N9w8wJg3PD+tyeOVI5h19rJsxC9jkeBQV0cUjLFLhDngij/jSGjSqqO7RjJj/EfCM7T9ViacwdBnlPQCGL6ub1IRfg9cB358lb9dP7cZ4Hcts/UNshQtQqhAEg8PJkfoliwWxdzc1Y63iHKcHZNcdQX5FNmisn6ZtTgLuNZj4djN0mjZ+QDWo/l2m8yMN1qteQAiZTUr4ej2Sjbas+C+DKCFT5xlruQiXCePK98rd38ASCvbvA2VWWYzzdKAbf4Gv/5Hnb0EOWY40ulx0MD6+vGqJVJH4G3p42OJASOX3kZvg1QzEbaNbxr7MiW8ebZsT3Nek3qReqzlIkaFVkO73xyfbaUrXrPqswZGl0QA5LEXEpbtYzy5nLL5Y7dahCTOvZsEPAvN5p9MXoN+tNZBGZTryU4cFNcMamHNtSa3KaCq31cBZo6IlqHKsELoyUZY9afj046TXQlMwAn3Wtx/KP1H6HlhffeCUc8HxBEDesDytmmPSqFzKYBPiZCJX32gM14Ao=
    - ewogICJ0aW1lc3RhbXAiIDogMTYyMDIwNjE0NDM3NCwKICAicHJvZmlsZUlkIiA6ICJmZDYwZjM2ZjU4NjE0ZjEyYjNjZDQ3YzJkODU1Mjk5YSIsCiAgInByb2ZpbGVOYW1lIiA6ICJSZWFkIiwKICAic2lnbmF0dXJlUmVxdWlyZWQiIDogdHJ1ZSwKICAidGV4dHVyZXMiIDogewogICAgIlNLSU4iIDogewogICAgICAidXJsIiA6ICJodHRwOi8vdGV4dHVyZXMubWluZWNyYWZ0Lm5ldC90ZXh0dXJlL2RlZmQ2MTU2ZmIzZGQ3MWU4YjA2MDBiNzg2NTIwNTM4N2Q4ODk3ZTk0MTBiZjcxNTA3OGJmNjAwOTY2ZTk5NTEiCiAgICB9CiAgfQp9;RRVZJPT//0IGJcOAO4vGN2GI2jwgyzri+AmcnweIr+gIiPU1rZWWPcKP/B2hnkUxpq9p+iXwHIjWpmBnvIKOk9m5zdkcg6gljw0enl42y4hMFG8V6wb9g36jfAMvZgMGJxuMSakM1+TXciSetFrU+AMtKI03boUTykO9rItozd+KCROTsl66EiPTjnN+0Irw/PWjg/ntcA+1CpB7BF8bZ0m64Da8yGRfPzdNXSQisugjf+AHRF95gizXt//8uCB9JWPEmZpUIfpA0EhISXcDUuSFcr4kxOUZY1eq/zNaSPbNJErZVqpMaOUFk/yMvkhLYaplrlqlo6MtOKKWz4PCLeDzpH0fJV3tAuIuRHjvUq0rq9afWQD5zE4kX4ShS/QwULB95Gekyuyu3wUdsd3QquCEP7qNAy64a1/Nf1dRq7YK68oIlYd+1XR6ufXy1Whjseunon8Qx2Sak2JF8Qz2Lunqx+bjDnDEMRCdpjQXWImJtPjo5KzswzzUthJA/aVAaHtz9a4Jg6jWY25Vb+byUXrzg+O1atB4ig6xUS/piSdLrRsmJpK3vKuOLMJr0tPMc1S/BqUr4pik8ar9YM7PC+3DuWDhhnkUSkkmIeEEm2iuiusXe779wcyBOlJIGCSzwJjSP5K7rllxMU02Y/6+kHYml93XHPwFrBmEdZge/E4=
    - ewogICJ0aW1lc3RhbXAiIDogMTYxNDcyMzY4OTQwNiwKICAicHJvZmlsZUlkIiA6ICI0NWY3YTJlNjE3ODE0YjJjODAwODM5MmRmN2IzNWY0ZiIsCiAgInByb2ZpbGVOYW1lIiA6ICJfSnVzdERvSXQiLAogICJzaWduYXR1cmVSZXF1aXJlZCIgOiB0cnVlLAogICJ0ZXh0dXJlcyIgOiB7CiAgICAiU0tJTiIgOiB7CiAgICAgICJ1cmwiIDogImh0dHA6Ly90ZXh0dXJlcy5taW5lY3JhZnQubmV0L3RleHR1cmUvZGIwOTEzZGY4MjI5NDFiMWU3ZDM4NDlmNTZmYTliNTRhNWY0MDdjZWVmNTIzYjc2MGQwNTdmMGQ1MDE3MzdhMiIsCiAgICAgICJtZXRhZGF0YSIgOiB7CiAgICAgICAgIm1vZGVsIiA6ICJzbGltIgogICAgICB9CiAgICB9CiAgfQp9;UAY1GksJ+m/HsWJa9mITe5QtrC8aaMh9JOZBiSxumeDCw5x4A8W4j4gFXkiJ3iTtedwsjKvL/ZFNVJcpU2D93hSmEQdEEVyHrdVUSY4nFj1JPpazztNjGaUDBB1YK8TdH0l93j8PdzVH0XywmumcLzeWuRmLYSl/U4aeBeTtXYZWEkN0l1Nq6KIR7E2Aj4p+dJhyfrTjODLQH/sG81orLdxyt7hyQQSvZa2tIQKRxALOyLzl+Qx69w7yHW3XhsElI2y+kdwNQrwOqXYmTTST7bBAgBlYmuS2pq8TDax2bF+q/TqokMMSl9YglEkCzYkG92VM8wC2342gXhoPzTCYF0Z1Ie5sGQJRNSXMw/Enaqz3jbZWlEXc72iZbqW7+ftPnte856lVcn9qdHALu3Yn+3aIppXXXB3WLmHuPFn4szbqk5bkqu5kAvvJPvV6KXqkH3Yx7T22QGeQV6BmsAOOOWF7QKREZaM5gSUTiFv/EuPxJWiOWOlpyteIS1CjyYhECWtHhRXwkuJpo0JSR5/q+mfx5kT8QaF72OwFFvy0QnbVLFlYFXDk/3u5fiGL9BoBqs4HWqqoGUuSGybVGgMR8thTSz0pOZ2MbZVA10TqPKYa8F9hBwfd0kwZsVPaz7VcniKMoGc7fgdrMc+EOti4lAzHhS7Eb8qkhzUoOseMofI=
    - ewogICJ0aW1lc3RhbXAiIDogMTU5ODA0NDgzODM0OSwKICAicHJvZmlsZUlkIiA6ICJkODAwZDI4MDlmNTE0ZjkxODk4YTU4MWYzODE0Yzc5OSIsCiAgInByb2ZpbGVOYW1lIiA6ICJ0aGVCTFJ4eCIsCiAgInNpZ25hdHVyZVJlcXVpcmVkIiA6IHRydWUsCiAgInRleHR1cmVzIiA6IHsKICAgICJTS0lOIiA6IHsKICAgICAgInVybCIgOiAiaHR0cDovL3RleHR1cmVzLm1pbmVjcmFmdC5uZXQvdGV4dHVyZS82YjM5NzRhOTdkNzM2ZWVhYTQxZmFmNTdmOGI4NDk2MDNlYWY2YWZhZTEzMmE5NzdjY2Y2NzNhMzgzYjFjZDhkIgogICAgfQogIH0KfQ==;EtdfcGhcROzs2q/MlgZzJyQThi/bwl6aLF6eLtLURcDnt+E27HYSRaosRygc2USR7mFofv1sW9ea1cSu61XyoUzNxIKx/WI8tYvoe3TJnnEDzcuM71dLK1LOtrqcFsk9A7hajuMGyBOydKE/FPej+BKq32rOKaG/7sFF+OfnP/raqNzxw+8Yz+RYmmSmRU4ih0YsRYH4wH0+Nui0f9bs31SH7BP08/Q17Iz5ObTUSQY0FxOg96SoImscoCUBimEMFIVgk0mmA2IpU2nYh3ctV7exFiDOx52PkyeQRLrXm/yf/fozLSsd+bK8Rzu6aKaiW/OJ8MrlQFnRnACeHRjL0XX6fbpotNLkdVDURG1DFINbKo8gaa1x4dcDTCLy6/g6/tEv6y7VUNqm+kXAr1ytef3iPXhfZvhG+RIIQ/YSH0GAPhy9/FmJiMzqabpLTjZdnAt8+M37YHinfLXMmWiuDkqJiKwg8hahv7QAQuQY1NfhETUFp6rdmTW4LhMbk74j72D6H9s2p5jcvXdkkB9o0i1YNR18hfFTW3yb7uL9ulgXCjQ616wfu3qEJp6rPQD2iqmT4h7l8dPGZQ2O+fgjYohwZgCkBLs2wT9xJhI2xGcbCXGPlIKFtwSOm/6Eao3Cd6XaB5fVUXEhyfHxhLiqNRVfJL8e4jOW5Pu2eWjHjMk=
    hunter:
    - ewogICJ0aW1lc3RhbXAiIDogMTYxODA2ODA4NDM1OCwKICAicHJvZmlsZUlkIiA6ICI2MTZiODhkNDMwNzM0ZTM3OWM3NDc1ODdlZTJkNzlmZCIsCiAgInByb2ZpbGVOYW1lIiA6ICJfX25vdGFodW1hbl9fIiwKICAic2lnbmF0dXJlUmVxdWlyZWQiIDogdHJ1ZSwKICAidGV4dHVyZXMiIDogewogICAgIlNLSU4iIDogewogICAgICAidXJsIiA6ICJodHRwOi8vdGV4dHVyZXMubWluZWNyYWZ0Lm5ldC90ZXh0dXJlL2JjZjlmOTFiZGE3NTRiNjkxNzExOTFjYjBhOTlkNWY1NTMzZmRkN2UzZTQ0ZDQ4ZDI2YjQ2YThiMjBiNGFlYTgiCiAgICB9CiAgfQp9;Bnl++v/eYrgFSbKXGHWWFYXYfzhrByxLTDK6a7cewIMszyr7Axjj0/8lhRnRdsNGn3sLbQn4QgLTQih+2k1IO6lvU4Nl2GTOaHT3DeSq96P2bdQmGSUtHIbrWbJSqJBId8XKNNMNKSwFcKxteeN/pw1cSzy6Inx+4bfZlBbgvMJE8dvCjG93aRU9CGRL2pQOL8DLjqms9OdOZmu1R5ZguwkddePpLkBmrfbwBKnGuVR85GNCliBCYRi9SQ+5NO5G6sOyd2Kl6ZBIX3mfOx+KBTGF3qxELJFgPeuijS2Wflbyjb9EOu6XIrMvWAJ42KGYqAsmC+EvIwXjRnhLPJHz+ocZwNCTON2N4u4blmDaKPgna3ND8oIMmHPmd15Z0TraUKrzK4sT7HedDPmcvERyPiOLQfq0fLmzBaqj7uj86Fg8YcjxUx29JMcPHmcC8L6ZvJD+0ui120F/fcEzVDpGmjJpfipKPlL2eLjRx59FnouLuDFxJNx6IvpmihvBMvB38DlMuTZcTR7Nkn3x5cZUh7YlSKkveRXQOKvXiRghI4nHA8O46u5gSIDFZ/XzieknuPK3qP1MVLuhU8U4DNmJzWfTSIFE1Fyckfanqq5EBWBXOe3vSPVjBmHWOg3P7JcM2kTpMipseq1w9pmNU2mQmAqliKU3SCLCV0kVqQyX+4g=
    - ewogICJ0aW1lc3RhbXAiIDogMTYxMjUyNjI2MzYzMCwKICAicHJvZmlsZUlkIiA6ICI4MmM2MDZjNWM2NTI0Yjc5OGI5MWExMmQzYTYxNjk3NyIsCiAgInByb2ZpbGVOYW1lIiA6ICJOb3ROb3RvcmlvdXNOZW1vIiwKICAic2lnbmF0dXJlUmVxdWlyZWQiIDogdHJ1ZSwKICAidGV4dHVyZXMiIDogewogICAgIlNLSU4iIDogewogICAgICAidXJsIiA6ICJodHRwOi8vdGV4dHVyZXMubWluZWNyYWZ0Lm5ldC90ZXh0dXJlL2EwZDA1YzE1MzAwMDUwMGZmMjg0M2E0MWNjMTc4Y2MwYTIyZWU1MjMwNmIxYTVkNjU3MzczNzkyOWRiNGVmMmIiCiAgICB9CiAgfQp9;rNscYkJreaOfTuddd7GN6heRDuN4I/6zvwCsUo+9D+oOc+tFbX0DByIgE/6/WiNt2jrAZ+nHDO1rqUKLT49R1IKeowluzg8huT7AEGVAkBOhWF7edtUmCiuv+tA58G9KMJci2EZTi6widKqgoLCwLcZZg2gh8wSHIHNwhr/br+EgVi8XJ8XslVFOmOzRJ+xfs1hUIJ2H8R02iPPw7ZrKB3bX3ogp3fN7s1yaRucUz36/D8IHBb/bAa4GhFgR7XfukXL25BpDOOCjDJaSZ/a5xgwxac6EgIZOWLd5EsOjPkNT+/+F6kUV6Tg7t5qznGD6wYfwKN8b+ePsVv8XQCuljWlnR4DVGsojcVLEp60H0lPMlitPsysEN3pevV5x8oeVH5QcLkAgky4Aj6y015fcWSppJJ3gHQ7yrtnjUpzW7cxKi/4CPYldtkXMF6XPIoeK5skR6t7DrqKJUw7T353yUusZkkR4e/Nqeu7zuHFAYk2Kw2Q/uLiXiLmO6r1XGLyHbSJcpgmpmrjPl+IJX+4t1+yeXlj58eAw5yNQCWKJsYeOE9R6D4ZM7G0zx6ADqN9H5wzqkV/DfTXtT+TkdkD5/85kq9uQIP0z0P0NEXz5azfi6ageX2bI1t9LESDkAXFsPGoNdH5MX7nPOmus+P0IS8njWzA8R0OqAiKlXV3yK18=
    pyromaniac:
    - ewogICJ0aW1lc3RhbXAiIDogMTU5MDM5ODcwNzQxNCwKICAicHJvZmlsZUlkIiA6ICJlZDUzZGQ4MTRmOWQ0YTNjYjRlYjY1MWRjYmE3N2U2NiIsCiAgInByb2ZpbGVOYW1lIiA6ICJGbGF3Q3JhQm90MDAiLAogICJzaWduYXR1cmVSZXF1aXJlZCIgOiB0cnVlLAogICJ0ZXh0dXJlcyIgOiB7CiAgICAiU0tJTiIgOiB7CiAgICAgICJ1cmwiIDogImh0dHA6Ly90ZXh0dXJlcy5taW5lY3JhZnQubmV0L3RleHR1cmUvMmEwMWQ3OGVkNTM0MTI0MzY2ODQ4N2Y2NzI4Zjc3NGFiNmU0YTg1YWFkZGNkZTk2Nzc4ODU2MTFlMDI3NjlkMCIKICAgIH0KICB9Cn0=;Fb1ajNUJl9MeGbvj62Da5aCKDjRMhwza4hqomlkeUHakSwJvnu7P+jWuMFCiUgJOC5TnZExRc5b1gcxnbZf35IjvljGS72g0sORqyNkT+pCnbxmMkgxLaEEA3WoE8sdJ+dV/jKr+hSrhMis4ihmayJzwJsvLgCmgO01nUQ1ZxBA2riWR/pFJ8aM5rCJCB6qAdVjwAOUYWr8kV/fHj+g5WnHxbPt/bHmQghuJZSRY5GV0mW7gLtVcaUHwTUEzOZM/p+oDmOQMPq8q0YrLYBR54vtXTXNyPEY3NMqprhFV9SBvBx34tg+ZFeWaRZfXQcaWEkdV1r14R4lBiZeIv8DOyt7AeUFuLmwo5XkqN9QLDq26l+1zfyjW5ZXbN/alBi2ashV289jiQW5fRcWF+JgTeA7R/AOFpQgOlfJIgiK+2rpYYu7SzmRkBPBVIeE42BryDdKhIl561I7T7x6zIng0ELsnrIi8fPofGzd2Ocq9R0R4ATLZywzui6R4SuuD/fg7Cb5rsG8WmJZzjgi04t7MK3diESM0mgJS7hzXsoJVdJ4gvp0RNSe4TL9VOs+c7qj3IPfKVP1Dc8SNcf0LoRz097DyReCKiQJwwT8w032gTLe6F072nbg6CJLRLHBrFPD4O8OcAXgqdehi/UhuXXmyPz6f6WQjNKHScPkUUG5LWIc=
    - ewogICJ0aW1lc3RhbXAiIDogMTU5MTU1NjE2MDE0OCwKICAicHJvZmlsZUlkIiA6ICI5MWZlMTk2ODdjOTA0NjU2YWExZmMwNTk4NmRkM2ZlNyIsCiAgInByb2ZpbGVOYW1lIiA6ICJoaGphYnJpcyIsCiAgInNpZ25hdHVyZVJlcXVpcmVkIiA6IHRydWUsCiAgInRleHR1cmVzIiA6IHsKICAgICJTS0lOIiA6IHsKICAgICAgInVybCIgOiAiaHR0cDovL3RleHR1cmVzLm1pbmVjcmFmdC5uZXQvdGV4dHVyZS83NGU4YzQ1M2Q0NTBmYzhiNGU2YmIyNzViNGRmMzVlMzYzNzc5MzIyZDdiM2YyZGY3YmM4YTAyNzZjMjZkNTllIgogICAgfQogIH0KfQ==;KfW9T9W3ClLo4UferjqEosDjeBGroCFkgl0bwkRCz079lPz83y/CJ1YQKJp89FR/rb32/x8fzg1tlRWRnCSbNcm0/qHZCaPxLLaHSfYFuD9nleOLC8URCyy6wJZ+oBnOzQxvHeFcFNJb7efYShofFcwkdgWyBew8diUmli0bo0ZPZ8QEb+BP6Q5KajcZlXYOm3jGgr9if0aO97pmq38AWrnZ3NxZlXioVxAGq/m2SQzRgBX2BswqXM356/KZfJPWF9aRiVF+e6l0WruIySd7bfTG5zwAczxgYi9ip92FFFyWJszgh9s8hOnAyAANU/4MzDD02DxNycG/30E3op0Fu41lUlfU7qQiS9UjTKWueRaJ1U0kMcRq2z6h9s3/cxmJUdkWRyfHt58GbEJsspSqJgsDaY5B4x5SPYe6MH15TSTC5U383cghD9bi3QNAr0MTTg9NSbMwvtkbzVyLiqySIWPLVYxZ33u93WkEDOVmGGkFmmYGmiJo0eoFLUg3dJMRghTPQRmCFPCR0hjZFW5yraEgkFGQq3/zrU587nnqF33QmWLJV0IKhTGX5BQYpqr2DmfAM0nyxEw6DWXLTl5mOBMV6WP21RXbrSpyj/Aj1QbiEVkgQ/0YCdaQ21wrkw/2QPkM7fGEQpeKqfD1v6WyTDN+OA2nogQXVzPS/AxERTc=
    - eyJ0aW1lc3RhbXAiOjE1NjgzNDk4MTc3OTYsInByb2ZpbGVJZCI6IjQ0MDNkYzU0NzViYzRiMTVhNTQ4Y2ZkYTZiMGViN2Q5IiwicHJvZmlsZU5hbWUiOiJHR0dhbWVyc1lUIiwic2lnbmF0dXJlUmVxdWlyZWQiOnRydWUsInRleHR1cmVzIjp7IlNLSU4iOnsidXJsIjoiaHR0cDovL3RleHR1cmVzLm1pbmVjcmFmdC5uZXQvdGV4dHVyZS9kYjRjNTVhMjMwZGMyY2UxYmFhYmY4MDE2MjJlYmUxNWFjMGI5NDhjMzY4NzMyMDYxZGNkOGU5ZTM1ZDQxYTM0In19fQ==;BVB9uj38SKL5QCOW4CE2D8edrODTXye9AljVMIr3MLllXHfadtJ6X4a/NYVtJD1JOWYUg3xfw7CEO+AxCpU7BbhhaGEMcLXVgBpnPXnK5tOLriDKSZwo3fTxH6af/I6cXWPDG+mEDb/cNkvNSGA79lfSElqL4wOTWrjVos+5P4QY5dIbFyKOqMXcZDfAM9WZKD2BlyFRsKQ/mc4fMPSEE7rOzbIMcD/Bb9Iujguuga/cXW2+ba9uu7LI/iSJo2YwhnmbxMLcXKY2Pks70q8zabICVTktlWs7GAzzBmu0MX51Kq/Ne+fMrsVBqo3bowF9pXn0cLIbDeMV7R/T/PmEdppv17Chtxwy6a4ZS/XdbhRvgr1l8hAiU6JLBt1tSbESsP2IaSIm3kFtHGafdgJXcVgWiMrsPzJD32NDVSpalwo1HU/DB29KkN1Su0f+PrzvANxTymd5yt1LHM94HaRkYPfaBa7bUc6N9tQI7+Mb1MeqbEBTEtdeEGxYaf3lsGjrCoUBFuaIQLuqVU7GMg5ENuOZV4q+e7SRUm5K2pUukI/nyM8s24XULU6v/B0Pj671btCGHit7nWUgKt5FCWfjqJW8g/iiQF0xIQvlgRu7Zxt6KEPXUWgsBypS2pT55UO3uUXorz4cJ8X3xQZT9ctIYAETAUf8QiF9mS668G4CS6Y=
    librarian:
    - ewogICJ0aW1lc3RhbXAiIDogMTYwNTc1MzY4NzQ4NCwKICAicHJvZmlsZUlkIiA6ICI0YjVkN2MxMTZlM2E0ZDYzYTVhMzMxNTdkZDZkNjdiOSIsCiAgInByb2ZpbGVOYW1lIiA6ICJfQXN0cmFwIiwKICAic2lnbmF0dXJlUmVxdWlyZWQiIDogdHJ1ZSwKICAidGV4dHVyZXMiIDogewogICAgIlNLSU4iIDogewogICAgICAidXJsIiA6ICJodHRwOi8vdGV4dHVyZXMubWluZWNyYWZ0Lm5ldC90ZXh0dXJlLzU2MDg5YTgyYmQ4ODAyZDY1YjdjZDJhN2JlNDJmYWI2YTBjZTZhMzgxOTc3MmRjMzAyY2FhOTRiNDA5OGRlMTkiCiAgICB9CiAgfQp9;Gljd1Yf/knmgpDyM+kJMgoezBUc8NC68WWizMNEmIkmXnVqTruao3geOZcmyDS8KFZzrOiaqnWn22j81ulMHHynQ0t7Hx+5kZsr+V71o6XnZhWR/Rr9kWrxrDYkV0CPtDCyRkVCRXk5Rp4hgh90aE2z0a6/FNbPDdRvtLaCIyMwaC3/QRk1qy70o6Y9zUFpxHX/o9o7BtIp6LvKQRq7iwU4e3j6ecSXHP75RiLqKCoSpqnaez8kOfZARseiYmUZqz1RvY/tLgOiOicIUFmHXzWvwZT//QSxrJeTdmZ5iO6LJP2dFUbuImIS1yRCRhy7TICHHyocFlCpe/kBFO0VBKecUnabTiCaCo/trCPgs7oKKf6RNrRgp/zLXbbHVx3JNpzhJ8maxtcfk9EN7jGdMQaTNRVasMq0pTt4ugAWS+TEyLF+Q9WeZDHW+I7xHjtEwjZiyWqk1lpFFEVgj3r/egEYDw8viDlqExQ9z9X2PwA41SfSwtKN16J7mv3m2ObCo+KheI5a+K4ylP62E7wVcWNwQyVrPPD209g4YFJvctmDGaNCzsOzKBiUqvDkMvCGdptpKZro2xUusce+EqICviuOlrdJiAvtKC6ncyk2vmHL1aVbehRx851Ko6X2I5UsdP8jkR/8NCz1AkjhhOb6sPbYdzjalZ1RUlQ69H2sdoQc=
    - ewogICJ0aW1lc3RhbXAiIDogMTYxNDcyNDM0NTYwMSwKICAicHJvZmlsZUlkIiA6ICJiYzRlZGZiNWYzNmM0OGE3YWM5ZjFhMzlkYzIzZjRmOCIsCiAgInByb2ZpbGVOYW1lIiA6ICI4YWNhNjgwYjIyNDYxMzQwIiwKICAic2lnbmF0dXJlUmVxdWlyZWQiIDogdHJ1ZSwKICAidGV4dHVyZXMiIDogewogICAgIlNLSU4iIDogewogICAgICAidXJsIiA6ICJodHRwOi8vdGV4dHVyZXMubWluZWNyYWZ0Lm5ldC90ZXh0dXJlLzU4YjE1N2ZkZjFjNDFjZTY4YjNlMWRlZmUzZjU5YWYyYTI4MDExZjM4MDkwMjMwNGUyOWE2NTU3OGY0NDRiMmQiLAogICAgICAibWV0YWRhdGEiIDogewogICAgICAgICJtb2RlbCIgOiAic2xpbSIKICAgICAgfQogICAgfQogIH0KfQ==;IRewbfSVadqEJpwBUTsnXx0EeRJhg1reqIEiTgGyK0MJ0Kj715Oy2uETyHQfmMm5kUCiukOUJXYyLcynX9lfh6OUC3/fYzP1JLGiVC/kLaxI0T7dhM6rO6+p1tY/L50V5/VLcJ1ISumSsIikP3pRSAeLoch9cPgXXbOVQ7HRIg+eKEh8wLoAVM8sKN9CzVANWo027JWC1fm1JBtrmk3KYNoSYRfcCwAgDRGMQ8kJ4BcohiKhrG3Dsjqn3fNgZhtyRguj/IJFlapHM/c3I5JoyXYJ6IJd+zKU6FcogAkbif6IbjFD+8+CMcivs2ycTPyjjsEOBt4Toj+ZfujcaH3mGnmVhe4hR/RGNCy1nr9GJugILPk4VzNJl3TAuHMq8+sOGU3id0dfsoyTMNUu7KwVyU1kR95NEc569xXYGYkyuqioi0eZfYLoAtrSJ0pWsEvnoUT325cX4UrN5GxZ2K9terfWPGXkVExnoB8rT4+RMNCE8cm/WU5AZtHFAgRVwbtfqVG2nbxKELk+BB6RaT/TopB213wrJyeT4adBFyZMbwmg99KbTcNrs6S4Q92bRdDj+gErmmKtinQA+KAbdFm0Hr70VMMVBsnPNNQdjUYPJOQsWpamMxPfEo8UXlW+NFT3L2hs8GdsAETwILZZ+YDc/mDHhQZEyiWttLHbgx0kWYM=
    - ewogICJ0aW1lc3RhbXAiIDogMTY0NjYxMTQ0MTc2NCwKICAicHJvZmlsZUlkIiA6ICIxNDU1MDNhNDRjZmI0NzcwYmM3NWNjMTRjYjUwMDE4NyIsCiAgInByb2ZpbGVOYW1lIiA6ICJMaWtlbHlFcmljIiwKICAic2lnbmF0dXJlUmVxdWlyZWQiIDogdHJ1ZSwKICAidGV4dHVyZXMiIDogewogICAgIlNLSU4iIDogewogICAgICAidXJsIiA6ICJodHRwOi8vdGV4dHVyZXMubWluZWNyYWZ0Lm5ldC90ZXh0dXJlL2Y2MTk5Nzc0NTBmNzI0NDM3MDdlZWVhZGJiZjU4MTMwNGRjMjZmOTY2YWRiMDJkMTMwOGEwZTVkMDIxNTEyMjkiCiAgICB9CiAgfQp9;pb84BCb3H/IDyF9VeyPr3Lf06ZgayJLtLRJrtpM/G9FqF2h+d7Y1WOp8jNDUAtHJ9Mlglctm+Uh5oUlicu697RUj+6o8blo6LzKe2z+uxWqYrbwHCHwmYxaeE1NusBqSn64GIzwotG2oixRGtp43Law7d1TaIroO8ICvOTLXC/l9B4Uz33cSJ5aOfkQHGy8y8SymTS2KmQOxkQNFmRDrMx4QxwTxPBUgBLwR7B7O1WPEAJVIq6LQCr29nZyL2DKSWanvoxBWZsG7maY4WQtpLe/HeCymAPbb6LRfeZW6h6GwhrmTl8EfVfk9fjXyClKhVsodYz4/sKPERA12CT1e//yR0ES3ItCnEsdoDn4Bg19hPRtCQU7oSwMNewEDTMbef1A2hcCAFUYeU+e4NJCXxu4anAWpLw7M/z2zkVZSNkPVg0ArKy4a/+yvRPou0SYYKPgudqrZCehLSYj/simxeBgqFz9AWmM/k8yp56A7f4R0pQYdmzn5xRLA0uHmOyYhLQwHPwiPX7XyONnby5+PyrHD7JouTyhHo9R9MEdeLCK1cyZhFnKWFaddS9VIv4Pd8MPtUXedkfM+wVwaGVmUeTChMZXNMEef9HcdcTIHOUFml5AmsjlpMViDpkjxc/FiIbW+xNNHG+Ohdsl7pT4figTi9d8EseI58AauDa3g1cc=
    fisherman:
    - eyJ0aW1lc3RhbXAiOjE1NjQ1OTg2MzkwNzIsInByb2ZpbGVJZCI6Ijc1MTQ0NDgxOTFlNjQ1NDY4Yzk3MzlhNmUzOTU3YmViIiwicHJvZmlsZU5hbWUiOiJUaGFua3NNb2phbmciLCJzaWduYXR1cmVSZXF1aXJlZCI6dHJ1ZSwidGV4dHVyZXMiOnsiU0tJTiI6eyJ1cmwiOiJodHRwOi8vdGV4dHVyZXMubWluZWNyYWZ0Lm5ldC90ZXh0dXJlLzlhZDJiYzNmNWRlMTNiZDI1YjlhMjM4OTIxMzExZGQ5OWRkNTU3NTJiNzBhNWI3NmQwOWY0NGY1ZWNlMGNkYjQifX19;Phx578kXVueZDg1cpGvDKSo1P4Y9HUe9/i5lK9l2KzQRsAv94yO+RGjQMp/z35WOu7xUFkzA/lmSH52baUhkpsWaqx56xuI2rWV/vJpnmKsaMOAOIRoByuloSDmcRk7CyWBPqHw4g2EWa+B+CCYEI2TZFfzNlmQgGRDYnzKaIEhN4kXKLL1vKA2HR6v/5i5oiAGyvr/znXs9EsTWyVIO2Th4DfuYNOJrBy3xJZ9wtj/mIY/E5xb8gk9eQXT5hOVStS/PAPQNGypOgrgcVmQ8NmbzKQDY2O8fOFSF4mUbn7W70YykRQPfFYOxNoZrAzLpFlk/ZWo96gNygwv3kdTHinFC7yB4SyRdhNreQ+Yu6irhka00rLiBR6yHjr+cqKryDEpcRTkdC51JeoiMVStw/2Uic2XMfnajyNNW/q/6bMcfm1KRKbzNB8iwZ0ghhE3spWc1CTqSJQzKswLGerxOpeBOTlGlKhU1yIsDjXIkoRKSFvbALl3zeLqtbmaO+VXTx8Ktemw6KUnaSJ6dK1Fjz1nsMts7+bwX2YGMP06HeUQDDN+067CKNff4UXxCvwujOrPNvqxA6KkH7WGNa3asA2VL6QuRFBe0VuIL58E/J9Cyb/kZagelrVe1UA6awHvlZsGhweMDU+xoUqeXX+sSzmlhHEyZA6o0dg/72fGoI1g=
    - ewogICJ0aW1lc3RhbXAiIDogMTYwMDExNTM3MTQwMSwKICAicHJvZmlsZUlkIiA6ICIxNzhmMTJkYWMzNTQ0ZjRhYjExNzkyZDc1MDkzY2JmYyIsCiAgInByb2ZpbGVOYW1lIiA6ICJzaWxlbnRkZXRydWN0aW9uIiwKICAic2lnbmF0dXJlUmVxdWlyZWQiIDogdHJ1ZSwKICAidGV4dHVyZXMiIDogewogICAgIlNLSU4iIDogewogICAgICAidXJsIiA6ICJodHRwOi8vdGV4dHVyZXMubWluZWNyYWZ0Lm5ldC90ZXh0dXJlL2Q5NDNkYzg2MzcxZTBhZTU1ZGZhOWFjYTkxNmVhMmU3ZmM0M2UyNmYzNzcwZDQyNjIwNzg1N2JkOWFlN2E5YmUiCiAgICB9CiAgfQp9;jpQE//5GSw64eKJhE6nyUUflag7mvK6xGMoyKyOmepIqHz9vWa9D02YhuHa/g8giqoRk/uHy3zMvbLEMTpE0yjUQvDwbGf5cmGcYlUcmbsxaLqW+kZaQyeHDj+g/4ubQIpGXYP3xi8lnt0HiViOeMMVwBwYdrT/K80g5W64qmVrX9FORxyY5SModPadnv9eHyirOrr0j0VjIHlkZ02RvE3PA/8mcWoTNDF8mPV57F7OOE96oqWQu+kNU/R9W52lEsgDJzmTrZPtys+9mbdi2hRIjni4AvOn/KtcClq8kxekOg2wm/VbMniOwWBm76VvFK45TVC9bHic+AEnuEmlfhJisOJhz4AqmbSoPE6IhNKiGwnIlJ8nSsui5NwNdcQU6pTjKdc+MKhsaGfDkI9NiG6ODgInj5UFNf9nsZx1jWtNkb/a0C4bLbgPrr9Wikj95FgyN7Y95okyLoWNooucv5mn6fJfvYfJibxuxIlqGaljwVm33Vt38NK6vSTFhFvN0t0p/oYxtJZmLU8DcWLjOfTzlGSZ/OU0TNnpWADb3oUo3UG2HsEfnikcWhbmw9k+3XA+PbEM43jnN/Ag7ZyuS5Wgc05b9PNZOax7BkHkc3NAct817lYl2UvuVZYG+REUgRgpRxpL/eL+EAfoYAURrd4K+Czk1SoNRE6fStyJeTOQ=
    collector:
    - ewogICJ0aW1lc3RhbXAiIDogMTU5NjA1NTY1NjM5NiwKICAicHJvZmlsZUlkIiA6ICIyYzEwNjRmY2Q5MTc0MjgyODRlM2JmN2ZhYTdlM2UxYSIsCiAgInByb2ZpbGVOYW1lIiA6ICJOYWVtZSIsCiAgInNpZ25hdHVyZVJlcXVpcmVkIiA6IHRydWUsCiAgInRleHR1cmVzIiA6IHsKICAgICJTS0lOIiA6IHsKICAgICAgInVybCIgOiAiaHR0cDovL3RleHR1cmVzLm1pbmVjcmFmdC5uZXQvdGV4dHVyZS8zZWFiZmQwMDBjNDliMDBhOTRmMTI5YjI1N2U2MGFhYjUwOTU1YmJiMTk2MGMxN2VhYjJjZGFhY2E4NmI2NzkwIgogICAgfQogIH0KfQ==;s9/WdPrm7kY4SZEh/tHgVpX6aQY8koBmrTfsFPVOpzPHsrXl4BsuD/a0IatwJUhZL/OEYyjlfQQaVXqUksmnatQC3Sj4EOBoT3c2s5TbyX/vySFR8euDEt0CgdSZowBVUij4UvIx+3iTG9jJPeLKrzh0KxDZ0M7qXF+05dhjMDfWcF9tqFOFZUKAp0drQ0j5dFF/buMwpFNp8tk26/FRSRZieUJNcSDfXqzXDWSQeUzkbQlWhFp7A+xi8sta+zqGY0jgiSlssuetqNdzQL1DK0oYyvjQmu3Fc5vjmPDaCKkwgec2WJkfgUkB7Ld6Lc6alzafTPP+8iZMZ/iei+MGH4CXPlLIFKsfP6drg47G6zc/n5kkayDqSmnbWgu2cqs26MQJ4liYtlg2xE8z9CudFHgNGMLr+u24OWf8BJSxVSpzzfcRjiRXSHpHWtPCSzvO9gXboLiqdMK1y6+Ki0nxbGRIrh5qnm8rFSuiFenv4fbHaI+N6cvnHgPuSNBdFM8BjykKO8offwR1xCuJ2OKowclLgOIt5wiPi6fpCQ66BhKw37gcLB47df3f00ongqXTu1+g+yxizB7Ru2Ur29nDBEsABG6u1yyYiTT7vvna+fi3WOJu0EzuopRSiBPBgavEVpcms7QbRj2xO6JY5W3+1ugQrasDPP5rKar4WLp37H0=
    - ewogICJ0aW1lc3RhbXAiIDogMTYyMDgyMDM3OTg5NCwKICAicHJvZmlsZUlkIiA6ICIzOWEzOTMzZWE4MjU0OGU3ODQwNzQ1YzBjNGY3MjU2ZCIsCiAgInByb2ZpbGVOYW1lIiA6ICJkZW1pbmVjcmFmdGVybG9sIiwKICAic2lnbmF0dXJlUmVxdWlyZWQiIDogdHJ1ZSwKICAidGV4dHVyZXMiIDogewogICAgIlNLSU4iIDogewogICAgICAidXJsIiA6ICJodHRwOi8vdGV4dHVyZXMubWluZWNyYWZ0Lm5ldC90ZXh0dXJlLzgxMzFhNDNmMDk2YjAxMDNlMzRiMDBiYTRiMzlkYjhjNjBhNGY2NWIzM2I0ZTEzZTQzNGJkNTVlZTllMWE3ZjMiCiAgICB9CiAgfQp9;b5q2/w0ErlRa/SsNpeZ263n56hbQZ75XqAzvDURQRWY8e4ggdgtPNEo7Yl9fyEAVSN3GxZLk71eKYZlHl6tLw4+qaCOEQXaTALdGhID9CzK+5QtFw/JGKhA/lvU5vxHiiWPULNVmtsEiku1+PAPRs0gQstLaRHu5rZez3Bz/W/yBsF3Hi4T7Ut2BsYlh8T41YZgVajICYJHm3EsuuWtDb3Hwc3KNRGBL5n3s/rkOs1XEw33pjt57RL+EdcxgkzGNUUqcVsOwiabpphoMLgSoE2SsvHmtCSHT7y3RvYNR1n7GCYVOd+G4/z3mnlYzLRT9cqG6We/miLOq/hXdDAdpK1kCfBBpN19Ezzgd+trXUz5MiglnjUkxbCyCPxTiHizvRcuOv2v91UsDgW7F5xd21sIDN6NklSWo9Dv8U/xNFsUB3hcsaJHQzxuAbtXShkkJYqgFKgvzFv4/rU8JeoDbl2Z1YgZDLQO1vqNhT++Vv0roDyVg5TbxIzVdR/vUGvSlI/gOKKSzqwS4/3q2eKiWYZ7j7EBZ8X1WZ5+W/r5JEuYbx3eDsEUjXMZbzkrLd8kZOq6lr6tQ9g5l2boYAeR4L5R+x417S7C7uPe+3zCMOyCDPMT/6D5+GFx9y7l8bShFkXR8O2p6EIJdrnXlf9bMtbwvldDzRtVBmSXmwh0o6iI=

AutomaticReload_Command:
    type: command
    name: bmrefresh
    usage: /bmrefresh
    permission: kingdoms.admin.bmrefresh
    description: self explanitory
    script:
    - run RefreshBlackMarketMerchants

RefreshBlackMarketMerchants:
    type: task
    script:
    - yaml load:blackmarket-formatted.yml id:bmf

    - define npcCount 0

    - narrate format:admincallout "Starting BM Merchant update tick..."

    - foreach <yaml[bmf].read[spawnlocation].exclude[factions].as[list].get[1].to_pair_lists>:

        - define merchantLoc <[value].get[2]>
        - define merchantType <[value].get[1]>

        - foreach <[merchantLoc]> as:currMerchantLoc:
            # Checks if location is empty
            - define npcCount:++
            - chunkload add <[merchantLoc].chunk> duration:1m
            - define merchantsAroundLoc <[currMerchantLoc].find_npcs_within[1]>
            #- narrate format:debug <[merchantsAroundLoc]>

            # If location already has an NPC on it then modify its inventory with the randomly-
            # fetched items from its reference list in the YAML
            - if <[merchantsAroundLoc].size> != 0:

                # If there are more than one NPCs in that area clear all but one
                # of them
                - if <[merchantsAroundLoc].size.is[MORE].than[1]>:
                    - foreach <[merchantsAroundLoc].remove[-1]>:
                        - remove <[value]>

                # Weighted random that favors smaller numbers
                #- define itemRandom <util.random.decimal[<util.random.decimal[0].to[0.44]>].to[<util.random.decimal[0.45].to[1]>]>
                - define itemRandom <util.random.decimal[0].to[<util.random.decimal[0.5].to[1]>]>
                - narrate format:debug <[itemRandom]>

                - define merchant <[merchantsAroundLoc].get[1]>
                - define slotNum 2

                #- narrate format:debug <[merchant]>

                # Clear all NPC inventories before re-filling them
                - inventory clear d:<[merchant].inventory>

                - adjust <[merchant]> skin_blob:<script[SkinTextureSignatures].data_key[<[value].get[1]>].get[<util.random.int[1].to[<script[SkinTextureSignatures].data_key[alchemist].size>]>]>

                # Check merchant location against list of faction spawn locations and flag merchant with appropriate faction
                - foreach <yaml[bmf].read[spawnlocation.factions].as[list].get[1].to_pair_lists> as:faction:
                    - define factionLoc <[faction].get[2]>
                    - define factionName <[faction].get[1]>

                    - foreach <[factionLoc]>:
                        - if <[currMerchantLoc]> == <[value].center>:
                            - flag <[merchant]> faction:<[factionName]>
                            - define factionColor <yaml[bmf].read[factiondata.<[factionName]>.color]>
                            - adjust <[merchant]> hologram_lines:<list[<[factionColor].parsed><yaml[bmf].read[factiondata.<[factionName]>.name]>|Faction:]>
                            - adjust <[merchant]> hologram_line_height:0.3

                            - foreach stop

                - foreach <yaml[bmf].read[merchant_items.<[value].get[1]>.items].to_pair_lists> as:pair:
                    - define itemName <[pair].get[1]>
                    - adjust def:itemName lore:<list>
                    - define itemName <[itemName].as_element.replace_text[i@]>

                    - define item <[pair].get[1].as[item]>
                    - define spawnChance <[pair].get[2]>

                    - if <[spawnChance].is[MORE].than[<[itemRandom]>]>:

                        # Amount random equation:
                        # x = 2.71828 ^(160000 / (price + 30000))
                        - define rawPrice <yaml[bmf].read[prices.<[itemName]>]>
                        - define amountRandomBound <element[2.71828].power[<element[160000].div[<[rawPrice].add[30000]>]>]>
                        - define amountRandom <util.random.int[1].to[<util.random.int[2].to[64]>]>

                        #- narrate format:debug ITM:<[item]>
                        #- narrate format:debug RAW:<[rawPrice]>

                        # Price is fetched from BMF file but minor fluctations are added to it with each refresh
                        - define priceMultiplier <util.random.decimal[1].to[<[spawnChance].add[<[rawPrice]>]>]>
                        - define price <[rawPrice].add[<[priceMultiplier]>].round>

                        # Set inventory to procedurally generated items and flag them with each of their
                        # prices and available amounts
                        - inventory set slot:<[slotNum]> o:<[item]> d:<[merchant].inventory>
                        - inventory flag slot:<[slotNum]> amount:<[amountRandom]> d:<[merchant].inventory>
                        - inventory flag slot:<[slotNum]> price:<[price]> d:<[merchant].inventory>
                        - inventory adjust slot:<[slotNum]> "lore:|<&color[#ffffff]>Amount Available<&co> <green><[amountRandom]>|<&color[#ffffff]>Price<&co> <red>$<proc[CommaAdder].context[<[price]>]>" d:<[merchant].inventory>
                        - define slotNum:+:1

                    - else:
                        - if <[merchant]>:
                            - despawn <[merchant]>

                - assignment set script:BMMerchant to:<[merchant]>
                #- narrate <[merchant]>
                - flag <[merchant]> isTrading:!

            - else:
                - create player <[merchantType].to_titlecase> <[currMerchantLoc].as[location]> save:BMMerchant
                - flag <entry[BMMerchant].created_npc> BMMerchant
                - lookclose <entry[BMMerchant].created_npc> state:true realistic
                - narrate format:admincallout "Creating new BM Merchant @ location: <[currMerchantLoc].as[location].xyz>"

            - chunkload remove <[merchantLoc].chunk>

    - narrate format:admincallout "Updated <[npcCount].color[red]> BM Merchants"
    - yaml id:bmf unload

BMMerchant:
    type: assignment
    actions:
        on assignment:
        - trigger name:click state:true
        - trigger name:entry state:true
        - trigger name:exit state:true
    interact scripts:
    - BMMerchant_I

BMMerchant_I:
    type: interact
    steps:
        1:
            click trigger:
                script:
                - if !<server.has_flag[RestrictedCreative]>:
                    - if !<npc.has_flag[isTrading]>:
                        - flag <npc> isTrading
                        - yaml load:blackmarket-formatted.yml id:bmf

                        - if <yaml[bmf].read[factiondata.opinions.<player.flag[kingdom]>.<npc.flag[faction]>].is[OR_MORE].than[0]>:
                            - yaml load:blackmarket-formatted.yml id:bmf

                            - foreach <npc.inventory.list_contents>:
                                - define opinionMultiplier <element[1].div[<yaml[bmf].read[factiondata.opinions.<player.flag[kingdom]>.<npc.flag[faction]>]>]>
                                - inventory flag slot:<[loop_index]> price:<[value].flag[price].mul[<[opinionMultiplier]>]>

                            - inventory open d:<npc.inventory>
                            - flag player BMInteract

                        - else:
                            - ratelimit <player> 10s
                            - random:
                                - narrate format:merchantspeak "No, go away"
                                - narrate format:merchantspeak "Can't trade with you. Faction policy..."
                                - narrate format:merchantspeak "No trade with your kingdom apparently. Sorry mate, I don't make the rules"
                            #- narrate format:callout "This faction refuses to trade with you. Your kingdom is not on good terms with them!"

                        - yaml unload id:bmf

                    - else:
                        - random:
                            - narrate format:merchantspeak "Yeah just a sec"
                            - narrate format:merchantspeak "I'll just get done over here"
                            - narrate format:merchantspeak "Form a queue, please!"
                            - narrate format:merchantspeak "A bit busy right now..."
                        #- narrate format:callout "This merchant is busy with someone else right now!"

                - else:
                    - narrate format:callout "Trading with the black market is disabled when restricted creative is on."

            entry trigger:
                script:
                - lookclose state:true

            exit trigger:
                script:
                - lookclose state:false
                - flag <npc> isTrading:!
                # Write look command to make npc return to normal

BMMerchant_Handler:
    type: world
    events:
        on player clicks in inventory flagged:BMInteract:
        - ratelimit player 3t
        - define price <context.item.flag[price]>
        - define amount <context.item.flag[amount]>

        # If player shift clicks, buy 10 of the item instead of
        # just 1

        - if <context.click> == SHIFT_LEFT:
            - define purchaseAmount 10
        - else:
            - define purchaseAmount 1

        # If there are enough items to buy and the player has
        # enough money to buy them all;

        - if <[amount].is[OR_MORE].than[<[purchaseAmount]>]>:
            - if <player.money.is[OR_MORE].than[<[price].mul[<[purchaseAmount]>]>]>:

                - inventory flag slot:<context.slot> amount:-:<[purchaseAmount]> d:<context.inventory>

                # take the appropriate amount of money and give
                # the player the items;

                - take money quantity:<[price].mul[<[purchaseAmount]>]>

                # Create item without any of the BM Item's flags or lore

                - define selectedItem <context.item>
                - adjust def:selectedItem lore:<list[]>
                - adjust def:selectedItem flag_map:<map[]>

                - if <context.item.material.name> == milk_bucket && <[price].is[MORE].than[50000]>:
                    - random:
                        - adjust def:selectedItem "lore:You are an idiot."
                        - adjust def:selectedItem "lore:I am a worthless waste of money."
                        - adjust def:selectedItem "lore:There are starving kids in Africa who|could have used that money..."
                        - adjust def:selectedItem "lore:For real? A bucket of milk named <context.item.display>?"
                        - adjust def:selectedItem "lore:<player.nameplate> wasted a total of:|<red>$<proc[CommaAdder].context[<[price]>]> <italic><dark_purple>on me."

                - give <[selectedItem]> quantity:<[purchaseAmount]>

                # change the display in the GUI to reflect the
                # purchase

                - inventory adjust slot:<context.slot> "lore:|<&color[#ffffff]>Amount Available<&co> <green><[amount].sub[<[purchaseAmount]>]>|<&color[#ffffff]>Price<&co> <red>$<proc[CommaAdder].context[<[price]>]>" d:<context.inventory>

                # If the player has made a promise to the faction
                # the npc is a part of them fullfill a part of the
                # promised trade. [SEE 'BlackMarketInfluence.dsc']

                - define kingdom <player.flag[kingdom]>

                - foreach <server.flag[promisedTrade<[kingdom]>]>:
                    - define currAmount <[value].get[1]>
                    - define currFaction <[value].get[2]>

                    #- narrate format:debug CF:<[currFaction]>

                    - if <server.has_flag[promisedTrade<[kingdom]>]>:
                        - if <[currFaction]> == <context.inventory.id_holder.flag[faction]>:

                            # I have to define the new amount as a
                            # separate variable since I can't modify
                            # certain list indexes directly when their
                            # inside flags

                            - define newTradeQuota <[value].get[1].sub[<[price]>]>
                            #- narrate format:debug <[newTradeQuota]>

                            # If the resultant of the transaction is that
                            # the trade quota remains above 0 then just
                            # change the value of the flag;

                            - if <[newTradeQuota].is[MORE].than[0]>:
                                - define originalAmount <[value].get[3]>
                                #- <list[<[newTradeQuota]>|<[currFaction]>|<[originalAmount]>]>
                                #- flag server promisedTrade<[kingdom]>:<server.flag[promisedTrade<[kingdom]>].overwrite[<list[<[newTradeQuota]>|<[currFaction]>|<[originalAmount]>]>].at[loop_index]>

                                - define newQuotaList <list>
                                - define insertIndex <[loop_index]>

                                - foreach <server.flag[promisedTrade<[kingdom]>]>:
                                    - if <[loop_index]> == <[insertIndex]>:
                                        - define newQuotaList <[newQuotaList].include_single[<list[<[newTradeQuota]>|<[currFaction]>|<[originalAmount]>]>]>

                                    - else:
                                        - define newQuotaList <[newQuotaList].include_single[<server.flag[promisedTrade<[kingdom]>].get[<[loop_index]>]>]>

                                #- narrate format:debug NQL:<[newQuotaList]>

                                - flag server promisedTrade<[kingdom]>:<[newQuotaList]>

                            # if not, then clear the flag and give the
                            # player a message - then recalculate the
                            # kingdom's influence.

                            - else:
                                - yaml load:blackmarket-formatted.yml id:bmf
                                - narrate format:callout "Promised trade quota with <red><bold><yaml[bmf].read[factiondata.<[currFaction]>.name]><&6> has been met!"

                                #- narrate format:debug "excess: <[newTradeQuota].sub[<[currAmount]>].abs>"

                                - run BMInfluenceRecalculate def:<[value].get[3]>|<[newTradeQuota].sub[<[currAmount]>].abs>|<[currFaction]>
                                - flag server promisedTrade<[kingdom]>:!
                                - yaml id:bmf unload

            - else:
                # Clicking outside the window returns -998 for some reason
                - if <context.slot> != -998 || <context.slot.is[OR_LESS].than[36]>:
                    - if <context.item> != <item[air]>:
                        - narrate format:callout "You do not have enough money to buy this item."

        - else:
            - if <context.item> != <item[air]>:
                - narrate format:callout "There is not enough of this item to buy."

        - determine cancelled

        on player closes inventory:
        - if <player.has_flag[BMInteract]>:
            - flag player BMInteract:!
            - flag <context.inventory.id_holder> isTrading:!
            #- narrate <context.inventory.id_holder>

BMRefresh_Handler:
    type: world
    events:
        on system time hourly every:24:
        - inject RefreshBlackMarketMerchants

merchantspeak:
    type: format
    format: "<blue><bold>[Merchant -<&gt> You] <&r><[text]>"